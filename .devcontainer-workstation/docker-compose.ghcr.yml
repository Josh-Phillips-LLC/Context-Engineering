services:
  implementation-workstation:
    image: ghcr.io/${GHCR_OWNER:-josh-phillips-llc}/${GHCR_IMAGE_PREFIX:-context-engineering-workstation}-implementation-specialist:${GHCR_IMAGE_TAG:-latest}
    container_name: implementation-workstation
    pull_policy: always
    volumes:
      - implementation_projects_data:/workspace
      - implementation_gh_config:/root/.config/gh
      - implementation_git_config:/root/.config/git
      - implementation_codex_home:/root/.codex
    environment:
      - GH_TOKEN=${GH_TOKEN:-}
      - OPENAI_API_KEY=${OPENAI_API_KEY:-}
      - WORKSTATION_DEBUG=${WORKSTATION_DEBUG:-false}
      - CODEX_HOME=/root/.codex
      - ROLE_PROFILE=${ROLE_PROFILE:-implementation-specialist}
      - WORKSPACE_REPO_URL=${WORKSPACE_REPO_URL:-https://github.com/Josh-Phillips-LLC/Context-Engineering.git}
      - WORKSPACE_REPO_DIR=/workspace/Projects/Context-Engineering
      - AUTO_CLONE_WORKSPACE_REPO=${AUTO_CLONE_WORKSPACE_REPO:-true}

    cap_add:
      - ALL
    privileged: true
    init: true
    entrypoint: ["/usr/local/bin/init-workstation.sh"]
    command: ["sleep", "infinity"]

  compliance-workstation:
    image: ghcr.io/${GHCR_OWNER:-josh-phillips-llc}/${GHCR_IMAGE_PREFIX:-context-engineering-workstation}-compliance-officer:${GHCR_IMAGE_TAG:-latest}
    container_name: compliance-workstation
    pull_policy: always
    profiles:
      - compliance-officer
    volumes:
      - compliance_projects_data:/workspace
      - compliance_gh_config:/root/.config/gh
      - compliance_git_config:/root/.config/git
      - compliance_codex_home:/root/.codex
    environment:
      - GH_TOKEN=${GH_TOKEN:-}
      - OPENAI_API_KEY=${OPENAI_API_KEY:-}
      - WORKSTATION_DEBUG=${WORKSTATION_DEBUG:-false}
      - CODEX_HOME=/root/.codex
      - ROLE_PROFILE=compliance-officer
      - WORKSPACE_REPO_URL=${WORKSPACE_REPO_URL:-https://github.com/Josh-Phillips-LLC/Context-Engineering.git}
      - WORKSPACE_REPO_DIR=/workspace/Projects/Context-Engineering
      - AUTO_CLONE_WORKSPACE_REPO=${AUTO_CLONE_WORKSPACE_REPO:-true}

    cap_add:
      - ALL
    privileged: true
    init: true
    entrypoint: ["/usr/local/bin/init-workstation.sh"]
    command: ["sleep", "infinity"]

volumes:
  implementation_projects_data:
  implementation_gh_config:
  implementation_git_config:
  implementation_codex_home:
  compliance_projects_data:
  compliance_gh_config:
  compliance_git_config:
  compliance_codex_home:
